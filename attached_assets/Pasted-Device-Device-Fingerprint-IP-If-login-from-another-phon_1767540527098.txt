Device = Device Fingerprint + IP

If login from another phone:

âŒ Show â€œMax device reachedâ€

âœ… User gets 1 self-reset per 24 hours

Admin can:

Reset anytime

Increase device limit (1 â†’ 2 â†’ N)

Reset reset-counter

ğŸ“¦ DATABASE DESIGN
ğŸ”¹ user_keys
id
user_id
key_value
max_devices INT DEFAULT 1
is_active TINYINT
expiry DATETIME

ğŸ”¹ key_devices
id
key_id
device_fingerprint VARCHAR(255)
ip_address VARCHAR(45)
country VARCHAR(50)
city VARCHAR(50)
ip_type ENUM('VPN','MOBILE','WIFI')
last_active DATETIME
is_active TINYINT

ğŸ”¹ key_resets
id
key_id
reset_count INT DEFAULT 0
last_reset DATETIME

ğŸ“² DEVICE FINGERPRINT (ANDROID)

Generate once and store locally:

ANDROID_ID
MODEL
MANUFACTURER
SDK_VERSION


Hash it (SHA-256) â†’ send to server.

ğŸ” LOGIN FLOW (SERVER LOGIC)
STEP 1: Validate Key
if (key expired OR inactive) â†’ reject

STEP 2: Check Existing Device
SELECT * FROM key_devices 
WHERE key_id=? AND is_active=1

âœ… If SAME device

â†’ allow login

âŒ If DIFFERENT device

â†’ check reset eligibility

ğŸ”„ 24-HOUR RESET LOGIC (USER SIDE)
if (reset_count < 1 AND now - last_reset >= 24h) {
    deactivate old device
    allow new device
    increment reset_count
    update last_reset
} else {
    return "MAX_DEVICE_REACHED"
}

ğŸ“± USER MESSAGE
âŒ Max device reached
You can reset once every 24 hours
Next reset in: 18h 22m

ğŸ‘‘ ADMIN OVERRIDE

Admin panel buttons:

ğŸ” Reset Device

ğŸ”¢ Change Max Devices

â™» Reset Reset-Counter

No time limit.

âœ… FEATURE 2: REAL-TIME DEVICE MAP (ANTI-ABUSE)
ğŸŒ DATA CAPTURE (ON EVERY API HIT)

Store:

IP

Country

City

ISP

VPN status

Last active timestamp

Use IP API (example):

ip-api / ipinfo / ipwhois

ğŸ“¦ device_activity TABLE
id
key_id
device_fingerprint
ip_address
country
city
isp
ip_type ENUM('VPN','MOBILE','WIFI')
last_seen DATETIME

ğŸŸ¢ ACTIVE STATUS LOGIC
if (last_seen >= now - 2 minutes)
â†’ ACTIVE ğŸŸ¢
else
â†’ OFFLINE ğŸ”´

ğŸ“Š ADMIN DASHBOARD VIEW

Per user / key:

ğŸŸ¢ Active Now
ğŸ“ India, Mumbai
ğŸŒ ISP: Jio
ğŸ”’ IP Type: Mobile
ğŸ•’ Last Seen: 30 sec ago
âš ï¸ VPN: No

ğŸš¨ UNUSUAL LOGIN TIME DETECTION

Store normal hours:

usual_login_start TIME
usual_login_end TIME


If login outside:

Flag as Suspicious

Show warning in admin panel

âœ… FEATURE 3: SILENT DATA WIPE COMMAND (NO APP UPDATE)
ğŸ¯ WHAT ADMIN CAN DO

From website:

Clear WebView cookies

Clear session / login

Force logout

Disable app instantly

ğŸ“¦ admin_commands TABLE
id
command ENUM(
  'CLEAR_COOKIES',
  'CLEAR_SESSION',
  'FORCE_LOGOUT',
  'DISABLE_APP'
)
target ENUM('ALL','KEY','USER')
target_id INT NULL
created_at DATETIME
is_executed TINYINT

ğŸ” APP CHECK FLOW

Every app open / refresh:

GET /api/check_commands?key=XXXX


Server responds:

{
  "clear_cookies": true,
  "clear_session": true,
  "force_logout": false,
  "app_enabled": true
}

ğŸ“± ANDROID ACTIONS
Command	Action
CLEAR_COOKIES	CookieManager.removeAllCookies()
CLEAR_SESSION	Clear SharedPreferences
FORCE_LOGOUT	Redirect to login
DISABLE_APP	Show maintenance screen